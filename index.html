<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tematick√© degustace v√≠n - Amantes Vinea Club</title>
    <!-- Tailwind CSS CDN pro stylov√°n√≠ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Pou≈æit√≠ fontu Inter pro modern√≠ vzhled -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Nastaven√≠ prim√°rn√≠ho fontu */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Svƒõtle ≈°ed√© pozad√≠ */
        }
        /* Styl pro karty s degustacemi, p≈ôid√°n√≠ zaoblen√≠ a st√≠nu */
        .tasting-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border-radius: 0.75rem; /* rounded-xl */
        }
        /* Efekt p≈ôi najet√≠ my≈°√≠ */
        .tasting-card:hover {
            transform: translateY(-8px); /* Vƒõt≈°√≠ posun pro dynamiƒçtƒõj≈°√≠ pocit */
            box-shadow: 0 15px 30px rgba(0,0,0,0.15); /* V√Ωraznƒõj≈°√≠ st√≠n */
        }
        /* Styl pro zobrazen√≠ programu (nap≈ô. ve Valtic√≠ch) */
        .schedule-status-required {
            color: #b91c1c; /* red-700 */
            font-weight: 600;
        }
        .schedule-status-optional {
            color: #059669; /* emerald-600 */
            font-weight: 600;
        }
        /* Styl pro polo≈æky v detailu akce */
        .detail-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .detail-item svg {
            color: #b91c1c; /* red-700 */
            margin-right: 0.5rem;
            width: 1.25rem;
            height: 1.25rem;
        }
        /* Styl pro informaƒçn√≠ boxy o odr≈Ød√°ch */
        .variety-info {
            background-color: #fff7ed; /* oran≈æov√°-50 */
            border-left: 4px solid #ea580c; /* oran≈æov√°-600 */
        }
        /* Animace pro naƒç√≠t√°n√≠ */
        @keyframes pulse-ai {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .animate-pulse-ai {
            animation: pulse-ai 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        /* Styl pro AI v√Ωstupy */
        .ai-response-box {
            background: linear-gradient(to right, #fdf4ff, #f5f3ff);
            border: 1px solid #e9d5ff;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            font-style: italic;
            color: #4c1d95;
            display: none; /* Skryt√© ve v√Ωchoz√≠m stavu */
        }
        .ai-response-box.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="app" class="container mx-auto p-4 md:p-12 max-w-6xl">
        
        <!-- HLAVN√ç STR√ÅNKA: P≈ôehled term√≠n≈Ø -->
        <div id="home">
            <header class="text-center mb-16 pt-8">
                <!-- Vlo≈æen√≠ loga s cestou k nahran√©mu souboru -->
                <img src="amantes_vinea_logo.png" alt="Logo klubu Amantes Vinea" class="h-28 mx-auto mb-6 drop-shadow-lg" onerror="this.onerror=null;this.src='https://placehold.co/250x110/374151/ffffff?text=Amantes+Vinea';">
                <h1 class="text-5xl md:text-6xl font-extrabold text-gray-900 mb-4 tracking-tight">
                    Tematick√© degustace
                </h1>
                <p class="text-xl text-gray-600 italic">
                    V√Ωjimeƒçn√© term√≠ny. Pouze pro ƒçleny klubu.
                </p>
            </header>
            
            <!-- Kontejner pro karty s degustacemi -->
            <main id="tasting-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10"></main>
        </div>

        <!-- DETAILN√ç STR√ÅNKA: Seznam v√≠n nebo program akce -->
        <div id="detail" class="hidden">
            <header class="mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <button id="back-button" class="bg-gray-800 text-white py-2 px-5 rounded-xl hover:bg-gray-700 transition-colors text-lg font-semibold shadow-lg">
                    &larr; Zpƒõt na p≈ôehled
                </button>
                <h1 id="detail-title" class="text-3xl md:text-4xl font-bold text-gray-900 text-right flex-1"></h1>
            </header>

            <!-- AI Gener√°tor pozv√°nek -->
            <div class="mb-10 bg-gradient-to-r from-purple-100 to-white p-6 rounded-xl border border-purple-200 shadow-sm flex flex-col sm:flex-row items-center justify-between gap-4">
                <div>
                    <h3 class="text-purple-900 font-bold text-lg flex items-center gap-2">
                        <span class="text-2xl">‚ú®</span> Pl√°nujete pozvat p≈ô√°tele?
                    </h3>
                    <p class="text-purple-700 text-sm">Nechte umƒõlou inteligenci napsat origin√°ln√≠ pozv√°nku na tuto akci.</p>
                </div>
                <button id="generate-invite-btn" class="bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all transform hover:scale-105 whitespace-nowrap">
                    ‚ú® Vygenerovat pozv√°nku
                </button>
            </div>
            
            <!-- M√≠sto pro zobrazen√≠ vygenerovan√© pozv√°nky -->
            <div id="invite-result-container" class="mb-8 hidden">
                <div class="bg-white p-6 rounded-xl shadow-md border-l-4 border-purple-500 relative">
                    <button onclick="this.parentElement.parentElement.classList.add('hidden')" class="absolute top-2 right-2 text-gray-400 hover:text-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                    <h4 class="font-bold text-gray-800 mb-2">N√°vrh pozv√°nky od AI:</h4>
                    <p id="invite-text" class="text-gray-700 italic leading-relaxed"></p>
                    <button onclick="copyInvite()" class="mt-4 text-sm text-purple-700 font-semibold hover:text-purple-900 flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                        Zkop√≠rovat text
                    </button>
                </div>
            </div>
            
            <!-- Kontejner pro informace o odr≈Ød√°ch (jen pro relevantn√≠ akce) -->
            <div id="variety-info-container" class="mb-8 hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="variety-info p-6 rounded-lg shadow-sm">
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Hibernal</h3>
                        <p class="text-sm text-gray-700 mb-2"><strong>P≈Øvod:</strong> Nƒõmecko (Geisenheim, 1944). K≈ô√≠≈æenec Seibel 7053 x Ryzlink r√Ωnsk√Ω. Pat≈ô√≠ mezi tzv. PIWI odr≈Ødy (rezistentn√≠).</p>
                        <p class="text-sm text-gray-700"><strong>Charakteristika:</strong> V√Ωraznƒõ aromatick√° odr≈Øda p≈ôipom√≠naj√≠c√≠ Sauvignon Blanc ƒçi Ryzlink. V≈Ønƒõ ƒçern√©ho ryb√≠zu, angre≈°tu, broskv√≠ a citrus≈Ø. Vy≈°≈°√≠ kyselinka dod√°v√° svƒõ≈æest.</p>
                    </div>
                    <div class="variety-info p-6 rounded-lg shadow-sm" style="border-left-color: #ca8a04; background-color: #fefce8;">
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Kerner</h3>
                        <p class="text-sm text-gray-700 mb-2"><strong>P≈Øvod:</strong> Nƒõmecko (Weinsberg, 1929). K≈ô√≠≈æenec Trol√≠nsk√© x Ryzlink r√Ωnsk√Ω. Pojmenov√°na po b√°sn√≠kovi a l√©ka≈ôi J. Kernerovi.</p>
                        <p class="text-sm text-gray-700"><strong>Charakteristika:</strong> Svƒõ≈æ√≠ v√≠na ryzlinkov√©ho typu, ale s ni≈æ≈°√≠ kyselinkou a plnƒõj≈°√≠m tƒõlem. Aromatika zahrnuje t√≥ny mu≈°k√°tu, b√≠l√Ωch kvƒõt≈Ø, merunƒõk a medu.</p>
                    </div>
                </div>
            </div>
            
            <!-- Kontejner pro detailn√≠ obsah (v√≠na nebo program) -->
            <main id="wine-list" class="space-y-6"></main>
        </div>
    </div>

    <script>
        // API kl√≠ƒç pro Gemini (bude doplnƒõn prost≈ôed√≠m)
        const apiKey = ""; 

        document.addEventListener('DOMContentLoaded', () => {
            // --- Data o degustac√≠ch ---
            let tastings = [
                {
                    id: 'traminy20260307', 
                    date: '2026-03-07',
                    displayDate: '7. b≈ôezna 2026 (16:30)',
                    theme: 'Tram√≠ny',
                    description: 'Pono≈ôte se do svƒõta jedn√© z nejstar≈°√≠ch a nejaromatiƒçtƒõj≈°√≠ch odr≈Ød. ƒåek√° v√°s v√Ωbƒõr tƒõch nejlep≈°√≠ch Tram√≠n≈Ø ƒçerven√Ωch a ko≈ôenit√Ωch.',
                    wineCount: 8,
                    image: 'tramin.png'
                },
                {
                    id: 'hibernalkerner20260109',
                    date: '2026-01-09',
                    displayDate: '9. ledna 2026',
                    theme: 'Odr≈Ødy Hibernal a Kerner',
                    description: 'Veƒçer vƒõnovan√Ω popul√°rn√≠m odr≈Ød√°m Hibernal a Kerner. Prozkoum√°me jejich aromatick√Ω profil, od svƒõ≈æ√≠ch t√≥n≈Ø a≈æ po pln√° vyzr√°l√° v√≠na.',
                    wineCount: 7,
                    image: 'hibernal_kerner.png' 
                },
                {
                    id: 'kralovskykostostrava20251101', 
                    date: '2025-11-01', 
                    displayDate: '1. listopadu 2025 (18:00 - 22:30)', 
                    theme: 'Kr√°lovsk√Ω ko≈°t Ostrava',
                    description: 'Pultov√° degustace nejlep≈°√≠ch v√≠n soutƒõ≈æe KR√ÅL V√çN ƒåesk√© republiky 2025. M√≠sto kon√°n√≠: Kulturn√≠ d≈Øm Akord, Ostrava-Z√°b≈ôeh.',
                    wineCount: 'Neomezenƒõ',
                    image: 'kralovsky_kost.png'
                },
                {
                    id: 'valtice20250926',
                    date: '2025-09-26', 
                    displayDate: '26. - 28. z√°≈ô√≠ 2025', 
                    theme: 'V√Ωjezdn√≠ setk√°n√≠ klubu ve Valtic√≠ch',
                    description: 'Tradiƒçn√≠ podzimn√≠ setk√°n√≠ na≈°eho klubu v srdci moravsk√©ho vina≈ôstv√≠. Tƒõ≈°it se m≈Ø≈æete na n√°v≈°tƒõvy skl√≠pk≈Ø, ≈ô√≠zen√© degustace a p≈ô√°telskou atmosf√©ru.',
                    wineCount: 'Nƒõkolik',
                    image: 'valtice.png'
                },
                {
                    id: 'cuvee20250725',
                    date: '2025-07-25', 
                    displayDate: '25. ƒçervence 2025', 
                    theme: 'Cuv√©e - umƒõn√≠ m√≠ch√°n√≠ v√≠n',
                    description: 'Prozkoumejte, jak vina≈ôi kombinuj√≠ r≈Øzn√© odr≈Ødy k dosa≈æen√≠ dokonal√© harmonie chut√≠ a v≈Øn√≠. ƒåek√° na v√°s 9 unik√°tn√≠ch cuv√©e.',
                    wineCount: 9,
                    image: 'cuvee.png'
                }
            ];

            // --- Detailn√≠ data o v√≠nech ---
            const wineData = [
                // DATA PRO HIBERNAL & KERNER
                { 
                    id: 'hibernalkerner20260109', 
                    wineId: 1, 
                    winery: 'Vina≈ôstv√≠ Koh√∫t ƒåejkovice', 
                    name: 'Hibernal 2023', 
                    classification: 'Moravsk√© zemsk√© v√≠no', 
                    sweetness: 'Such√©', 
                    alcohol: '12,5 %', 
                    origin: 'Morava, Velkopavlovick√°', 
                    pairing: 'Asijsk√© speciality, ch≈ôest, koz√≠ s√Ωry' 
                },
                { 
                    id: 'hibernalkerner20260109', 
                    wineId: 2, 
                    winery: 'Vina≈ôstv√≠ u Svobod≈Ø ≈†atov', 
                    name: 'Kerner 2024', 
                    classification: 'Pozdn√≠ sbƒõr', 
                    sweetness: 'Polosladk√©', 
                    alcohol: '11,5 %', 
                    origin: 'Morava, Znojemsk√°', 
                    pairing: 'Ovocn√© dezerty, jemn√© s√Ωry s modrou pl√≠sn√≠' 
                },
                { 
                    id: 'hibernalkerner20260109', 
                    wineId: 3, 
                    winery: 'Z√°meck√© vina≈ôstv√≠ Bzenec', 
                    name: 'Kerner 2022', 
                    classification: 'Pozdn√≠ sbƒõr', 
                    sweetness: 'Polosuch√©', 
                    alcohol: '12,5 %', 
                    origin: 'Morava, Mikulovsk√°', 
                    pairing: 'Telec√≠ maso, tƒõstoviny se smetanovou om√°ƒçkou' 
                },
                { 
                    id: 'hibernalkerner20260109', 
                    wineId: 4, 
                    winery: 'Vinselect Michlovsk√Ω', 
                    name: 'Hibernal 2023', 
                    classification: 'Pozdn√≠ sbƒõr', 
                    sweetness: 'Such√©', 
                    alcohol: '13,0 %', 
                    origin: 'Morava, Mikulovsk√°', 
                    pairing: 'Mo≈ôsk√© plody, v√Ωraznƒõj≈°√≠ √∫pravy ryb, ko≈ôenƒõn√° j√≠dla' 
                },
                { 
                    id: 'hibernalkerner20260109', 
                    wineId: 5, 
                    winery: 'Vina≈ôstv√≠ Tvar≈Ø≈æek', 
                    name: 'Kerner 2024', 
                    classification: 'V√Ωbƒõr z hrozn≈Ø', 
                    sweetness: 'Polosladk√© (Zbyt. cukr: 32 g/l, Kyseliny: 7,0 g/l)', 
                    alcohol: '12,5 %', 
                    origin: 'Morava, Znojemsk√°', 
                    pairing: 'Dezerty, v√Ωrazn√© s√Ωry' 
                },
                { 
                    id: 'hibernalkerner20260109', 
                    wineId: 6, 
                    winery: 'Vina≈ôstv√≠ Vladim√≠r Tetur', 
                    name: 'Hibernal 2023', 
                    classification: 'Pozdn√≠ sbƒõr', 
                    sweetness: 'Polosladk√©', 
                    alcohol: '12,0 %', 
                    origin: 'Morava, Velkopavlovick√°', 
                    pairing: 'Ovocn√© sal√°ty, hus√≠ j√°tra, asijsk√° kuchynƒõ' 
                },
                { 
                    id: 'hibernalkerner20260109', 
                    wineId: 7, 
                    winery: 'Vina≈ôstv√≠ Zapletal', 
                    name: 'Kerner 2022', 
                    classification: 'Pozdn√≠ sbƒõr', 
                    sweetness: 'Such√©', 
                    alcohol: '12,5 %', 
                    origin: 'Morava, Velkopavlovick√° (Velk√© B√≠lovice)', 
                    pairing: 'Ku≈ôec√≠ maso, kvalitn√≠ s√Ωry' 
                },

                // DATA PRO CUV√âE
                { id: 'cuvee20250725', wineId: 1, winery: 'Vina≈ôstv√≠ Koh√∫t', name: 'Cuv√©e "d√°msk√° j√≠zda" 2023', classification: 'Moravsk√© zemsk√© v√≠no', sweetness: 'Polosuch√©', alcohol: '12,5 %', origin: 'Morava, ƒåesk√° republika', pairing: 'Tƒõstoviny, dr≈Øbe≈æ, du≈°en√© maso' },
                { id: 'cuvee20250725', wineId: 2, winery: 'Vina≈ôstv√≠ Proch√°zka Valtice', name: 'Cuv√©e (Sauvignon & Cabernet Blanc)', classification: 'Moravsk√© zemsk√© v√≠no', sweetness: 'Polosladk√©', alcohol: '12,0 %', origin: 'Morava, ƒåesk√° republika (Valtice)', pairing: null },
                { id: 'cuvee20250725', wineId: 3, winery: 'Vina≈ôstv√≠ Hraniƒçn√≠ z√°meƒçek', name: 'Romantick√© cuv√©e', classification: 'Moravsk√© zemsk√© v√≠no', sweetness: 'Polosladk√©', alcohol: '11,5 %', origin: 'Morava, ƒåesk√° republika (Lednicko-valtick√Ω are√°l)', pairing: null },
                { id: 'cuvee20250725', wineId: 4, winery: 'Vina≈ôstv√≠ Gertner', name: 'Cuv√©e Lena 2024', classification: 'Moravsk√© zemsk√© v√≠no', sweetness: 'Polosladk√© (Zbyt. cukr: 28,7 g/l, Kyseliny: 6,0 g/l)', alcohol: '11,5 %', origin: 'Morava, Slov√°ck√° podoblast, obec Star√Ω Poddvorov', pairing: null },
                { id: 'cuvee20250725', wineId: 5, winery: 'V√çNO HRU≈†KA s.r.o.', name: 'Dƒõv√≠n & Mu≈°k√°t moravsk√Ω 2023', classification: 'Kabinetn√≠ v√≠no', sweetness: 'Polosuch√© (Zbyt. cukr: 13,7 g/l, Kyseliny: 6,5 g/l)', alcohol: '11,5 %', origin: 'Morava, Slov√°ck√° podoblast, obec Jalub√≠, tra≈• Vinohr√°dky', pairing: null },
                { id: 'cuvee20250725', wineId: 6, winery: 'V√çNO HRU≈†KA s.r.o.', name: 'Tram√≠n ƒçerven√Ω & Ryzlink r√Ωnsk√Ω 2023', classification: 'Pozdn√≠ sbƒõr', sweetness: 'Polosladk√© (Zbyt. cukr: 29,8 g/l, Kyseliny: 7,0 g/l)', alcohol: '11,0 %', origin: 'Morava, Slov√°ck√° podoblast, obec Blatniƒçka, tra≈• Vinohr√°dky', pairing: null },
                { id: 'cuvee20250725', wineId: 7, winery: 'V√çNO HRU≈†KA s.r.o.', name: 'Cuv√©e Nikol 2021', classification: 'V√Ωbƒõr z hrozn≈Ø', sweetness: 'Polosladk√© (Zbyt. cukr: 27,9 g/l, Kyseliny: 7,2 g/l)', alcohol: '12,5 %', origin: 'Morava, Slov√°ck√° podoblast, obec Blatniƒçka, tra≈• Novosady', pairing: null },
                { id: 'cuvee20250725', wineId: 8, winery: 'Vina≈ôstv√≠ Koneƒçn√Ω, ƒåejkovice', name: 'Cuv√©e Dave√© b√≠l√© 2022', classification: 'Moravsk√© zemsk√© v√≠no', sweetness: 'Polosladk√© (Zbyt. cukr: 33,9 g/l, Kyseliny: 7,0 g/l)', alcohol: '12,5 %', origin: 'Morava, Slov√°ck√° podoblast, obec Star√Ω Poddvorov, tra≈• Kr√°sn√° hora', pairing: 'Doporuƒçujeme k romantick√Ωm veƒçe≈ô√≠m a veƒçer≈Øm.' },
                { id: 'cuvee20250725', wineId: 9, winery: 'Z√°meck√© vina≈ôstv√≠ Bzenec', name: 'EGO No.57 2023', classification: 'Jakostn√≠ v√≠no odr≈Ødov√©', sweetness: 'Polosuch√© (Zbyt. cukr: 11,4 g/l, Kyseliny: 7,1 g/l)', alcohol: '13,5 %', origin: 'Morava', pairing: 'Ocenƒõn√≠: Vina≈ô roku 2016 & 2021, 8x titul ≈†ampion Salonu v√≠n' }
            ];

            // --- Detailn√≠ programy akc√≠ ---
            const eventDetails = [
                {
                    id: 'kralovskykostostrava20251101', 
                    schedule: [
                        { day: 'Informace k pultov√© degustaci', items: [
                            { time: 'M√≠sto kon√°n√≠', description: 'Kulturn√≠ centrum Akord Ostrava, n√°mƒõst√≠ SNP 1, Ostrava-Z√°b≈ôeh', status: '' },
                            { time: 'ƒåas', description: '18:00 - 22:30', status: '√öƒçast povinn√°' },
                            { time: 'Degustace', description: 'Neomezen√° pultov√° degustace nejlep≈°√≠ch ƒçesk√Ωch a moravsk√Ωch v√≠n z KR√ÅLE V√çN ƒåR 2025.', status: 'All-inclusive' },
                            { time: 'Obƒçerstven√≠', description: 'Drobn√© obƒçerstven√≠ k v√≠nu od partner≈Ø KR√ÅLE V√çN a voda ≈†umavsk√Ω pramen.', status: 'V cenƒõ' },
                            { time: 'Doprovodn√Ω program', description: 'Interaktivn√≠ komunikace, soutƒõ≈æe o vinn√© ceny, tombola.', status: 'Dobrovolnƒõ' },
                            { time: 'Katalog', description: 'E-kniha KR√ÅL V√çN 2025 a e-Katalog v√≠n s mo≈ænost√≠ pozn√°mek k degustovan√Ωm vzork≈Øm.', status: 'V cenƒõ' }
                        ] }
                    ]
                },
                {
                    id: 'valtice20250926',
                    schedule: [
                        { day: '1. den (P√°tek)', items: [ 
                            { time: '15:00', description: 'Ubytov√°n√≠ a voln√Ω program', status: 'Dobrovolnƒõ' },
                            { time: '17:00', description: 'N√°v≈°tƒõva Sal√≥nu v√≠n, Valtice (vstupenky zaji≈°tƒõny)', status: '√öƒçast povinn√°' } 
                        ] },
                        { day: '2. den (Sobota)', items: [ 
                            { time: '10:00', description: 'Pƒõ≈°√≠ t√∫ra vinicemi', status: 'Dobrovolnƒõ' }, 
                            { time: '13:00', description: 'Setk√°n√≠ v Lednici, spoleƒçn√Ω obƒõd (degustace m√≠stn√≠ch specialit)', status: '√öƒçast povinn√°' }, 
                            { time: '18:00', description: 'Veƒçern√≠ ≈ô√≠zen√° degustace ve skl√≠pku (Vina≈ôstv√≠ T≈ôi Brat≈ôi)', status: '√öƒçast povinn√°' } 
                        ] },
                        { day: '3. den (Nedƒõle)', items: [ 
                            { time: '10:00', description: 'Degustace v Lednicko-valtick√©m are√°lu', status: 'Dobrovolnƒõ' }, 
                            { time: '13:00', description: 'Rozlouƒçen√≠ a odjezd', status: '' } 
                        ] }
                    ]
                }
            ];

            // --- Reference na DOM elementy ---
            const homePage = document.getElementById('home');
            const detailPage = document.getElementById('detail');
            const tastingListContainer = document.getElementById('tasting-list');
            const wineListContainer = document.getElementById('wine-list');
            const detailTitle = document.getElementById('detail-title');
            const backButton = document.getElementById('back-button');
            const varietyInfoContainer = document.getElementById('variety-info-container');
            const generateInviteBtn = document.getElementById('generate-invite-btn');
            const inviteResultContainer = document.getElementById('invite-result-container');
            const inviteText = document.getElementById('invite-text');

            // --- GEMINI API FUNKCE ---

            /**
             * Zavol√° Gemini API pro generov√°n√≠ textu.
             */
            async function callGemini(prompt) {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
                
                const data = {
                    contents: [{
                        parts: [{ text: prompt }]
                    }]
                };

                // Exponenci√°ln√≠ backoff pro retry (max 5 pokus≈Ø)
                for (let i = 0; i < 5; i++) {
                    try {
                        const response = await fetch(url, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });

                        if (!response.ok) {
                            if (response.status === 429) throw new Error('Too Many Requests');
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();
                        return result.candidates?.[0]?.content?.parts?.[0]?.text || "Omlouv√°me se, AI moment√°lnƒõ nem≈Ø≈æe odpovƒõdƒõt.";
                    } catch (error) {
                        if (i === 4) return "Omlouv√°me se, do≈°lo k chybƒõ p≈ôi komunikaci s AI slu≈æbou.";
                        const waitTime = Math.pow(2, i) * 1000;
                        await new Promise(resolve => setTimeout(resolve, waitTime));
                    }
                }
            }

            // Funkce pro generov√°n√≠ p√°rov√°n√≠ j√≠dla (AI Sommelier)
            window.askSommelier = async function(btn, name, winery, sweetness, classification) {
                const containerId = btn.dataset.target;
                const resultContainer = document.getElementById(containerId);
                const originalText = btn.innerHTML;
                
                // UI update: Naƒç√≠t√°n√≠
                btn.disabled = true;
                btn.innerHTML = `‚ú® P≈ôem√Ω≈°l√≠m...`;
                btn.classList.add('opacity-75', 'cursor-not-allowed');
                
                const prompt = `Jsi zku≈°en√Ω a kreativn√≠ sommeli√©r. Doporuƒç konkr√©tn√≠ a l√°kav√Ω pokrm k v√≠nu: ${name} od ${winery} (${sweetness}, ${classification}). Vysvƒõtli struƒçnƒõ (max 2-3 vƒõty), proƒç se k sobƒõ chutƒõ hod√≠. Odpovƒõz ƒçesky, p≈ô√°telsky a profesion√°lnƒõ.`;

                const responseText = await callGemini(prompt);
                
                // UI update: Zobrazen√≠ v√Ωsledku
                resultContainer.innerHTML = `<strong>üí° Tip AI Sommeli√©ra:</strong> ${responseText}`;
                resultContainer.classList.add('active');
                
                // Reset tlaƒç√≠tka
                btn.innerHTML = originalText;
                btn.disabled = false;
                btn.classList.remove('opacity-75', 'cursor-not-allowed');
            };

            // Funkce pro generov√°n√≠ pozv√°nky
            let currentTastingForInvite = null;
            
            generateInviteBtn.addEventListener('click', async () => {
                if (!currentTastingForInvite) return;
                
                const originalText = generateInviteBtn.innerHTML;
                generateInviteBtn.disabled = true;
                generateInviteBtn.innerHTML = `‚ú® Tvo≈ô√≠m pozv√°nku...`;
                inviteResultContainer.classList.add('hidden');
                
                const prompt = `Napi≈° kr√°tkou, vtipnou a l√°kavou e-mailovou pozv√°nku (max 3-4 vƒõty) pro ƒçleny klubu na degustaci v√≠n s t√©matem: '${currentTastingForInvite.theme}'. Kdy: ${currentTastingForInvite.displayDate}. Popis akce: ${currentTastingForInvite.description}. Pou≈æij emotikony. Odpovƒõz ƒçesky.`;
                
                const responseText = await callGemini(prompt);
                
                inviteText.innerText = responseText;
                inviteResultContainer.classList.remove('hidden');
                
                generateInviteBtn.innerHTML = originalText;
                generateInviteBtn.disabled = false;
            });

            // Pomocn√° funkce pro kop√≠rov√°n√≠
            window.copyInvite = function() {
                const text = inviteText.innerText;
                navigator.clipboard.writeText(text).then(() => {
                    alert("Text pozv√°nky byl zkop√≠rov√°n do schr√°nky!");
                });
            };

            // --- KONEC GEMINI API FUNKC√ç ---

            function getTimeRemaining(dateString) {
                const eventDate = new Date(dateString);
                eventDate.setHours(0, 0, 0, 0);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const diffTime = eventDate - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays < -3) return 'Probƒõhlo'; 
                if (diffDays <= 0) return 'Pr√°vƒõ prob√≠h√°';
                if (diffDays === 1) return 'Z√≠tra!';
                if (diffDays < 7) return `Za ${diffDays} dny`;
                if (diffDays <= 30) return `Za ${diffDays} dn√≠`;
                return `Za ${Math.floor(diffDays / 30)} mƒõs√≠c≈Ø`;
            }

            function renderHomePage() {
                tastingListContainer.innerHTML = '';
                tastings.sort((a, b) => new Date(b.date) - new Date(a.date));

                tastings.forEach(tasting => {
                    const dayInfo = getTimeRemaining(tasting.date);
                    const firstTwoWords = tasting.theme.split(' ').slice(0, 2).join('+');
                    
                    const card = `
                        <div class="tasting-card bg-white rounded-xl shadow-lg overflow-hidden cursor-pointer" data-id="${tasting.id}">
                            <img src="${tasting.image}" alt="Obr√°zek k t√©matu ${tasting.theme}" 
                                 class="w-full h-52 object-cover" 
                                 onerror="this.onerror=null;this.src='https://placehold.co/600x400/374151/ffffff?text=${firstTwoWords}';">
                            <div class="p-6">
                                <p class="text-sm font-semibold mb-2 ${dayInfo.includes('Prob√≠h√°') || dayInfo.includes('Z√≠tra') ? 'text-red-600' : 'text-gray-500'}">
                                    ${dayInfo} &middot; ${tasting.displayDate}
                                </p>
                                <h2 class="text-2xl font-bold text-gray-900 mt-1 mb-3">${tasting.theme}</h2>
                                <p class="text-gray-600 mb-5">${tasting.description}</p>
                                <div class="flex justify-between items-center text-sm font-medium border-t pt-4">
                                    <span class="text-gray-500">Poƒçet vzork≈Ø: <span class="text-gray-900 font-bold">${tasting.wineCount}</span></span>
                                    <span class="text-red-700 font-bold hover:text-red-900 transition-colors">
                                        Zobrazit detaily <span aria-hidden="true">&rarr;</span>
                                    </span>
                                 </div>
                            </div>
                        </div>`;
                    tastingListContainer.innerHTML += card;
                });
                
                document.querySelectorAll('.tasting-card').forEach(card => {
                    card.addEventListener('click', () => showDetailPage(card.dataset.id));
                });
            }

            function showDetailPage(tastingId) {
                const selectedTasting = tastings.find(t => t.id === tastingId);
                if (!selectedTasting) return;
                
                currentTastingForInvite = selectedTasting; // Ulo≈æ√≠me pro generov√°n√≠ pozv√°nky
                detailTitle.textContent = selectedTasting.theme;
                wineListContainer.innerHTML = '';
                inviteResultContainer.classList.add('hidden'); // Skr√Ωt p≈ôedchoz√≠ v√Ωsledek pozv√°nky

                if (tastingId === 'hibernalkerner20260109') {
                    varietyInfoContainer.classList.remove('hidden');
                } else {
                    varietyInfoContainer.classList.add('hidden');
                }

                const winesForTasting = wineData.filter(w => w.id === tastingId);
                const detailsForEvent = eventDetails.find(e => e.id === tastingId);

                if (winesForTasting.length > 0) {
                    winesForTasting.forEach((wine, index) => {
                        const pairingBoxId = `pairing-box-${wine.id}-${wine.wineId}`;
                        const wineCardHTML = `
                            <div class="bg-white rounded-xl shadow-lg p-6 border-l-8 border-red-700">
                                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-3">
                                    <h3 class="text-2xl font-extrabold text-gray-900">
                                        <span class="text-red-700">${index + 1}.</span> ${wine.name}
                                    </h3>
                                    <!-- Tlaƒç√≠tko pro AI Sommeli√©ra -->
                                    <button class="mt-2 md:mt-0 text-sm bg-purple-100 hover:bg-purple-200 text-purple-800 font-bold py-1.5 px-4 rounded-full transition-colors flex items-center gap-1"
                                            data-target="${pairingBoxId}"
                                            onclick="askSommelier(this, '${wine.name}', '${wine.winery}', '${wine.sweetness}', '${wine.classification}')">
                                        ‚ú® Co k tomu j√≠st? (AI Tip)
                                    </button>
                                </div>
                                <p class="text-lg text-gray-700 font-semibold mb-4">${wine.winery}</p>
                                
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6 text-sm">
                                    <div><p class="text-gray-500">Klasifikace</p><p class="font-bold text-gray-800">${wine.classification}</p></div>
                                    <div><p class="text-gray-500">Cukernatost</p><p class="font-bold text-gray-800">${wine.sweetness}</p></div>
                                    <div><p class="text-gray-500">Alkohol</p><p class="font-bold text-gray-800">${wine.alcohol}</p></div>
                                    <div class="md:col-span-1"><p class="text-gray-500">P≈Øvod</p><p class="font-bold text-gray-800">${wine.origin}</p></div>
                                </div>
                                
                                ${wine.pairing ? `
                                <div class="mt-6 p-4 bg-gray-50 rounded-lg border-l-4 border-gray-300">
                                    <p class="text-gray-500 font-medium">Pozn√°mka / Doporuƒçen√≠</p>
                                    <p class="font-medium text-gray-800">${wine.pairing}</p>
                                </div>` : ''}

                                <!-- Kontejner pro odpovƒõƒè AI -->
                                <div id="${pairingBoxId}" class="ai-response-box text-sm mt-4"></div>
                            </div>`;
                        wineListContainer.innerHTML += wineCardHTML;
                    });
                
                } else if (detailsForEvent) {
                    detailsForEvent.schedule.forEach(day => {
                        if (day.day === 'Informace k pultov√© degustaci') {
                            wineListContainer.innerHTML += `
                                <div class="bg-white rounded-xl shadow-lg p-6">
                                    <h3 class="text-2xl font-bold text-gray-900 mb-4">${day.day}</h3>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        ${day.items.map(item => {
                                            let icon = '';
                                            if (item.time.includes('M√≠sto kon√°n√≠')) icon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" /></svg>`;
                                            else if (item.time.includes('ƒåas')) icon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>`;
                                            else if (item.time.includes('Degustace')) icon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.53-7.5a.75.75 0 0 0-1.06 0l-.357.357a.75.75 0 0 1-1.06 0L12 9.75l-.357.357a.75.75 0 0 1-1.06 0l-.357-.357a.75.75 0 0 0-1.06 0V15a.75.75 0 0 0 .75.75h9a.75.75 0 0 0 .75-.75V8.25a.75.75 0 0 0-1.06 0Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25h1.5M9 21h1.5M12 17.25h1.5M12 21h1.5M15 17.25h1.5M15 21h1.5" /></svg>`;
                                            else if (item.time.includes('Obƒçerstven√≠')) icon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.2 48.2 0 0 1 10.978 0Z" /></svg>`;
                                            else if (item.time.includes('Doprovodn√Ω program')) icon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M15.406 13.911a3.75 3.75 0 1 1-5.819-3.413 3.75 3.75 0 0 1 5.819 3.413Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M14.5 19.5a7.5 7.5 0 0 0 7.5-7.5 7.5 7.5 0 0 0-7.5-7.5 7.5 7.5 0 0 0-7.5 7.5 7.5 7.5 0 0 0 7.5 7.5Z" /></svg>`;
                                            else if (item.time.includes('Katalog')) icon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M13.5 10.5H9.75m6.75 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>`;
                                            return `
                                                <div class="detail-item">
                                                    ${icon}
                                                    <div>
                                                        <p class="text-gray-500 font-medium">${item.time}</p>
                                                        <p class="font-bold text-gray-800">${item.description}</p>
                                                    </div>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>
                            `;
                        } else {
                            const dayHtml = `
                                <div class="bg-white rounded-xl shadow-lg p-6 border-l-8 border-red-500">
                                    <h3 class="text-2xl font-bold text-gray-900 mb-4">${day.day}</h3>
                                    <ul class="space-y-4">
                                        ${day.items.map(item => `
                                            <li class="flex flex-col sm:flex-row sm:items-center p-3 border-b last:border-b-0">
                                                <span class="font-extrabold w-24 text-gray-800 text-lg sm:text-base">${item.time || 'Cel√Ω den'}</span>
                                                <span class="flex-1 text-gray-700 pr-4">${item.description}</span>
                                                <span class="text-xs uppercase px-3 py-1 rounded-full whitespace-nowrap 
                                                    ${item.status.includes('povinn√°') ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'} font-bold">
                                                    ${item.status}
                                                </span>
                                            </li>
                                        `).join('')}
                                    </ul>
                                </div>
                            `;
                            wineListContainer.innerHTML += dayHtml;
                        }
                    });
                } else {
                     wineListContainer.innerHTML = `<p class="text-center text-xl p-8 bg-white rounded-xl shadow-lg text-gray-500">Pro tuto ud√°lost zat√≠m nen√≠ k dispozici detailn√≠ program. Tƒõ≈°te se na dal≈°√≠ informace!</p>`;
                }
                
                homePage.classList.add('hidden');
                detailPage.classList.remove('hidden');
                window.scrollTo(0, 0); 
            }
            
            function showHomePage() {
                detailPage.classList.add('hidden');
                homePage.classList.remove('hidden');
            }

            backButton.addEventListener('click', showHomePage);

            renderHomePage();
        });
    </script>
</body>
</html>